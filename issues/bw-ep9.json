{
  "assignee": "",
  "blocked_by": [],
  "blocks": [],
  "created": "2026-02-20T20:34:47Z",
  "description": "## Problem\n\nNo way to permanently remove an issue. close-with-reason covers most cases but does not clean up the issue data. Reviewer noted this as not critical but worth having.\n\n## bd alignment\n\nbd delete \u003cid\u003e without --force shows a preview of what would be affected. With --force it deletes the issue and removes all dependency links. Children are orphaned (parent reference cleared), not cascade-deleted. bd also has --cascade for recursively deleting dependents, and --dry-run as an explicit flag. For bw, we match the core UX: preview by default, --force to execute.\n\n## Implementation\n\n### Data model (internal/issue/issue.go)\n\nAdd DeletePlan struct:\n    type DeletePlan struct {\n        Issue    *Issue\n        Blocks   []string   // issues this blocks (links to remove)\n        BlockedBy []string  // issues blocking this (links to remove)\n        Children []string   // issues where Parent == this ID (will be orphaned)\n    }\n\nAdd Store.DeletePreview(id string) (*DeletePlan, error):\n  - Resolve ID, load issue\n  - Scan for children: list all issues, find those with Parent == id\n  - Return DeletePlan with affected relationships\n\nAdd Store.Delete(id string) error:\n  1. Resolve ID, load issue to get current status\n  2. Remove issue JSON (issues/\u003cid\u003e.json)\n  3. Remove status marker (status/\u003cstatus\u003e/\u003cid\u003e)\n  4. Remove outgoing blocks markers (blocks/\u003cid\u003e/*)\n  5. Remove incoming blocks markers (blocks/*/\u003cid\u003e)\n  6. For every issue in Blocks list: load, remove id from BlockedBy, write\n  7. For every issue in BlockedBy list: load, remove id from Blocks, write\n  8. For every issue where Parent == id: load, clear Parent, write\n  9. Return nil on success\n\n### CLI (cmd/bw/delete.go) -- new file\n- DeleteArgs{ID, Force, JSON}\n- parseDeleteArgs: positional \u003cid\u003e, flags --force, --json\n- cmdDelete:\n  Without --force: call store.DeletePreview(), display preview:\n      DELETE PREVIEW\n\n      Issue to delete:\n        bw-a3f8: Fix login bug [P2 task]\n\n      Dependency links to remove: 2\n        bw-a3f8 blocks bw-b2c1\n        bw-a3f8 blocked by bw-c3d2\n\n      Children to orphan: 1\n        bw-d4e5: Login subtask\n\n      To proceed: bw delete bw-a3f8 --force\n\n  With --force: call store.Delete(), commit with intent 'delete \u003cid\u003e'\n\n### Intent replay (internal/intent/intent.go)\n- Add case 'delete': in replayOne\n- replayDelete: parse 'delete \u003cid\u003e', call store.Delete(), commit\n\n### Command registration (cmd/bw/command.go)\n- Add to commands array with positional \u003cid\u003e, flags --force and --json\n- Add 'delete' to 'Working With Issues' group\n\n## Acceptance criteria\n\n- [ ] bw delete \u003cid\u003e (no --force) shows preview without modifying anything\n- [ ] Preview lists the issue details, dependency links to remove, and children to orphan\n- [ ] Preview ends with 'To proceed: bw delete \u003cid\u003e --force'\n- [ ] bw delete \u003cid\u003e --force removes the issue JSON and status marker\n- [ ] --force removes blocks marker files in both directions\n- [ ] --force updates BlockedBy/Blocks arrays on related issues\n- [ ] --force clears Parent field on child issues (orphans them)\n- [ ] bw show \u003cdeleted-id\u003e returns error after deletion\n- [ ] bw list does not show deleted issue\n- [ ] Related issues no longer reference deleted issue in blocks/blocked_by\n- [ ] Child issues have empty Parent after deletion\n- [ ] bw delete nonexistent returns error\n- [ ] Intent: delete creates git commit with 'delete \u003cid\u003e' message\n- [ ] Intent replay correctly applies delete intents\n- [ ] bw delete --help shows usage\n- [ ] bw delete \u003cid\u003e --force --json outputs deleted issue details as JSON\n\n## Test requirements\n\n- Unit test for Store.DeletePreview returning correct plan\n- Unit test for Store.Delete removing issue file\n- Unit test for Store.Delete removing status marker\n- Unit test for Store.Delete cleaning up blocks markers\n- Unit test for Store.Delete updating related issues BlockedBy/Blocks\n- Unit test for Store.Delete orphaning children (clearing Parent)\n- Unit test for Store.Delete on issue with no dependencies (clean delete)\n- Unit test for delete preview output format\n- Unit test for delete with --force output\n- Unit test for delete nonexistent issue error\n- Unit test for intent replay of delete\n- Integration test: create parent + child + dependencies, delete parent, verify cleanup\n- Existing tests pass (go test ./...)",
  "id": "bw-ep9",
  "labels": [],
  "priority": 2,
  "status": "in_progress",
  "title": "Add bw delete command",
  "type": "feature",
  "updated_at": "2026-02-20T20:37:45Z"
}

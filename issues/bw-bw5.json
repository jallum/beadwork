{
  "assignee": "",
  "blocked_by": [],
  "blocks": [],
  "closed_at": "2026-02-20T20:49:08Z",
  "created": "2026-02-20T20:33:26Z",
  "description": "## Problem\n\nThe Parent field exists in the Issue struct (issue.go:77), bw show displays it (helpers.go:233-235), and bw import sets it (import.go:154-158), but there is no CLI path to set it. No --parent flag on bw create or bw update.\n\n## bd alignment\n\nbd create --parent \u003cid\u003e and bd update --parent \u003cid\u003e (empty string to clear). We match exactly, but improve on bd by adding integrity checks.\n\n## Integrity checks (where we improve on bd)\n\nbd has zero parent integrity checking -- allows self-parent and cycles silently. We add:\n1. Self-parent rejection: --parent \u003cid\u003e where resolved id == self -\u003e error\n2. Cycle detection: walk ancestor chain (parent -\u003e parent.parent -\u003e ...) before setting. If the new child appears anywhere in the chain, reject with error. O(depth), parents are typically shallow.\n3. Parent existence validation: --parent \u003cid\u003e must resolve to an existing issue (unless clearing with empty string)\n4. These checks apply in both Store.Create (parent set at creation) and Store.Update (reparenting)\n\n## Implementation\n\n### Data model (internal/issue/issue.go)\n- Add Parent string to CreateOpts\n- Add Parent *string to UpdateOpts\n- Store.Create: if opts.Parent != '', validate parent exists (resolveID), set issue.Parent = opts.Parent\n- Store.Update: if opts.Parent != nil:\n  - If *opts.Parent == '' -\u003e clear parent (valid)\n  - If *opts.Parent == id -\u003e error 'cannot set issue as its own parent'\n  - Else: validate parent exists, walk ancestor chain to detect cycles, then set\n\n### CLI (cmd/bw/create.go)\n- Add Parent string to CreateArgs\n- Parse --parent flag in parseCreateArgs\n- Set opts.Parent = ca.Parent in cmdCreate\n- Include parent=\u003cid\u003e in intent string if set\n\n### CLI (cmd/bw/update.go)\n- Add Parent string, ParentSet bool to UpdateArgs\n- Parse --parent flag in parseUpdateArgs\n- If ParentSet: set opts.Parent, add to changes slice as parent=\u003cid\u003e\n\n### Command registration (cmd/bw/command.go)\n- Add {Long: '--parent', Value: 'ID', Help: 'Parent issue ID'} to both create and update flag lists\n\n### Intent replay (internal/intent/intent.go)\n- In replayUpdate, add case 'parent': opts.Parent = \u0026val\n\n## Acceptance criteria\n\n- [ ] bw create 'Child' --parent \u003cparent-id\u003e sets the Parent field\n- [ ] bw show \u003cchild-id\u003e displays Parent: \u003cparent-id\u003e\n- [ ] bw update \u003cid\u003e --parent \u003cnew-parent-id\u003e reparents the issue\n- [ ] bw update \u003cid\u003e --parent '' clears the parent\n- [ ] bw create 'X' --parent nonexistent returns error\n- [ ] bw update \u003cid\u003e --parent \u003csame-id\u003e returns 'cannot set issue as its own parent' error\n- [ ] Cycle detection: if A is parent of B, bw update A --parent B returns cycle error\n- [ ] Deep cycle detection: A-\u003eB-\u003eC chain, bw update A --parent C returns cycle error\n- [ ] bw create --help shows --parent flag\n- [ ] bw update --help shows --parent flag\n- [ ] Intent replay handles parent=\u003cid\u003e in update intents\n- [ ] bw show --json includes parent field\n\n## Test requirements\n\n- Unit test for Store.Create with Parent in CreateOpts\n- Unit test for Store.Update setting parent\n- Unit test for Store.Update clearing parent (empty string)\n- Unit test for self-parent rejection\n- Unit test for direct cycle detection (A parent of B, set B as parent of A)\n- Unit test for deep cycle detection (A-\u003eB-\u003eC, set C as parent of A)\n- Unit test for parent validation (nonexistent ID)\n- Unit test for intent replay with parent key-value\n- Existing tests pass (go test ./...)",
  "id": "bw-bw5",
  "labels": [],
  "priority": 1,
  "status": "closed",
  "title": "Add --parent flag to create and update",
  "type": "feature",
  "updated_at": "2026-02-20T20:49:08Z"
}
